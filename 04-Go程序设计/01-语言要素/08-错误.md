[TOC]

### 错误与异常

#### error

> 错误是发生非期望的已知行为

1. Go内置错误接口类型error，任何类型只要实现Error方法都可以传递接口类型变量
2. Go典型的错误处理方式是将error作为函数最后一个返回值，检测其是否为nil
3. 如果一个函数返回error类型变量，则先用if处理err!=nil,正常逻辑放到if后面
4. defer语句应该放到err判断后面，不然可能产生panic

~~~go
if err, file := os.Open(path); err != nil {
    // code
}
~~~

定制错误

~~~go
var LessThanTwoError = errors.New("n shoule not less than 2") // 定义错误类
~~~

#### panic

> 异常时发生非期望的未知行为

注意事项

1. 引发panic方式一种是主动panic，一种是程序出现运行时异常检测抛出
2. 发生panic会立即返回，逐层向上执行defer（如果存在），打印函数调用栈，直到recover或者退出
3. recover用来捕获panic,并且阻止panic继续向上传递,但是recover只会在defer中才能捕获panic

~~~go
defer func() {
    if err := recover(); err != nil {
        fmt.Println(err)
    }    
}()
~~~

5. 可以出现多个panic，但是只能在defer中，但是只有最后一次的panic才能被捕获
6. init函数引发的panic只能在init函数中捕获，init函数先于main函数执行
7. 函数不能捕获goroutine抛出的panic
8. panic的参数是一个空接口类型，所以可以接受任意的类型