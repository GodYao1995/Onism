[TOC]

### 包管理

#### GOPATH

~~~bash
/Users/apple-liyao/Desktop/Go
~~~

该目录下有3个默认的子目录, 一般需要自己创建,他们分别是

| 目录 |            作用            |
| :--: | :------------------------: |
| bin  | go install生成的可执行文件 |
| pkg  |    go编译生成的归档文件    |
| src  |           源代码           |

**说明**

1.  工作目录就是我们用来存放代码的地方, 包括源代码以及依赖包
2.  GOPATH可以设置多个, 以区分不同的项目构建

**缺点**

无依赖版本控制

#### MOD

1.13版本以上推荐使用了Go mod, GOPATH不再作为项目源码构建使用

##### 快速迁移

1.  添加环境变量, 开启 Go modules

~~~go
GO111MODULE=on
~~~

2.  设置 GOPROXY【在中国是必须的,因为它的默认值被墙了】【可选七牛或者阿里】

~~~bash
GOPROXY=https://goproxy.cn,direct  # 用于指示 Go 回源到模块版本的源地址去抓取
~~~

3.  GOSUMDB
    *   GOSUMDB的默认值为：`sum.golang.org`
    *   但是 GOSUMDB 可以被 Go 模块代理所代理
4.  GONOPROXY/GONOSUMDB/GOPRIVATE
    *   用在当前项目依赖了私有模块, 
    *   公司的私有 git 仓库, 又或是 github 中的私有库, 都是属于私有模块, 都是要进行设置的

##### 命令

|      命令       |               作用               |
| :-------------: | :------------------------------: |
|   go mod init   |         生成 go.mod 文件         |
| go mod download | 下载 go.mod 文件中指明的所有依赖 |
|   go mod tidy   |          整理现有的依赖          |
|  go mod graph   |        查看现有的依赖结构        |
|   go mod edit   |         编辑 go.mod 文件         |
|  go mod vendor  |  导出项目所有的依赖到vendor目录  |
|  go mod verify  |     校验一个模块是否被篡改过     |
|   go mod why    |     查看为什么需要依赖某模块     |

##### 初始化

##### mod文件

它描述了当前项目的元信息,每一行都以一个动词开头,目前有以下 5 个动词

|  动词   |                 意义                 |
| :-----: | :----------------------------------: |
| module  |        定义当前项目的模块路径        |
|   go    |          设置预期的Go 版本           |
| require |        设置一个特定的模块版本        |
| exclude |    从使用中排除一个特定的模块版本    |
| replace | 将一个模块版本替换为另外一个模块版本 |

**说明**

indirect 标识表示该模块为间接依赖

##### sum文件

1.  详细罗列了当前项目直接或间接依赖的所有模块版本
2.  写明了那些模块版本的 SHA-256 哈希值以备 Go 在今后的操作中保证项目所依赖的那些模块版本不会被篡改
3.  sum文件需要提交, 保证大家的都是一致的

##### 缓存

1.  拉取的包全部在GOPATH/pkg/mod下
2.  同一个模块版本的数据只缓存一份, 所有其它模块共享使用

~~~bash
go clean -mocache # 清空
~~~
