[TOC]

### 幂等性

#### HTTP幂等性

一次或者多次请求某个资源, 应当产生同样的副作用

##### 问题

- [x] 服务端处理成功, 但是客户端未收到成功反馈, 导致"重试", 或者客户端误操作导致重试
- [x] SQL的幂等问题, 如下的SQL不是幂等的

~~~sql
UPDATE POINTS SET point -= 10 WHERE user_id = 1;
~~~

##### 解决办法：Token

Token or Ticket 操作标示

##### 优势

- [ ] 简单, 不会引入复杂的分布式事务
- [ ] 可用性以及性能都相对较好

##### HTTP幂等性

目前主流HTTP服务为REST风格, 面向资源设计, 幂等性不是属于HTTP协议本身, 但是在具体业务设计方面会有影响

PUT、DELETE、GET、HEAD、OPTIONS、TRACE 都是幂等的

###### GET

获取资源, 无副作用, 是幂等的

###### DELETE

删除资源, 有副作用, 但是也是幂等的

###### POST

创建资源, 有副作用, 返回创建资源本身, 不是幂等的

###### PUT

更新资源(如果存在)否则创建, 有副作用, **是幂等的**

#### 分布式系统接口幂等性
