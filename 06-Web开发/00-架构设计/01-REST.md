[TOC]

### REST

#### Web应用模式

##### 前后端不分离

1.  一次请求包含了网页所需的页面与数据
2.  利于SEO
3.  前后端耦合度较高
4.  不利于不同平台数据的获取

##### 前后端分离

1.  静态文件与数据分开请求,减轻了数据服务器的压力
2.  不利于SEO
3.  前后端分离开发效率提高
4.  利于其他平台数据获取(只需向外界提供统一的数据接口与返回的数据格式)

#### REST API

> RESTful是一种设计风格,但是逐渐的变成前后端分离的一种"标准"

##### 协议：HTTPS

- [x] 使用HTTPS协议增加网站的安全性

~~~
https://api.example.com   # 尽量部属在专属的域名下（存在跨域的问题）
https://example.org/api/  # 如果api很简单可以部署在主域名下
~~~

##### API版本

- [ ] 版本变化大可以设置在子域名中
- [x] 简单的将版本放置在路径中

~~~
https://api.example.com/v1/
~~~

##### URL设计: 以资源为中心的

- [x] 资源尽量采用名词复数
- [ ] 尽量使用小写

~~~
https://api.example.com/v1/zoos
https://api.example.com/v1/animals
https://api.example.com/v1/employees
~~~

##### 正确的HTTP动词

| 方法   | 描述                                                         |
| :----- | :----------------------------------------------------------- |
| HEAD   | 只获取某个资源的头部信息. 比如只想了解某个文件的大小, 某个资源的修改日期等 |
| GET    | 获取资源                                                     |
| POST   | 创建资源                                                     |
| PATCH  | 更新资源的部分属性                                           |
| PUT    | 替换资源, 客户端需要提供新建资源的所有属性                   |
| DELETE | 删除资源                                                     |

##### 不符合CRUD资源情况

- [x] 使用POST来执行动作
- [ ] 增加控制参数
- [ ] 将动作转换成资源

##### 状态码

###### 200 OK

- [x] 请求成功接收并处理, 一般响应中都会有 body

###### 201  Created

- [x] 请求已完成, 并导致了一个或者多个资源被创建
- [ ] 最常用在 POST 创建资源

###### 202  Accepted

- [x] 请求已经接收并开始处理, 但是处理还没有完成
- [ ] 一般用在异步处理的情况, 响应 body 中应该告诉客户端去哪里查看任务的状态

###### 204  No Content

- [x] 请求已经处理完成, 但是没有信息要返回
- [ ] 用在 PUT 更新资源的时候(客户端提供资源的所有属性, 因此不需要服务端返回). 如果有重要的 metadata, 可以放到头部返回

###### 301  Moved Permanently

- [x] 请求的资源已经永久性地移动到另外一个地方, 后续所有的请求都应该直接访问新地址
- [ ] 服务端会把新地址写在 `Location` 头部字段, 方便客户端使用. 允许客户端把 POST 请求修改为 GET

###### 304  Not Modified

- [x] 请求的资源和之前的版本一样, 没有发生改变.
- [ ] 用来缓存资源, 和条件性请求（conditional request）一起出现

###### 307  Temporary Redirect

- [x] 目标资源暂时性地移动到新的地址, 客户端需要去新地址进行操作, 但是**不能**修改请求的方法. 

###### 308  Permanent Redirect

- [x] 和 301 类似, 除了客户端**不能**修改原请求的方法

###### 400  Bad Request

- [x] 客户端发送的请求有错误（请求语法错误, body 数据格式有误, body 缺少必须的字段等）
- [ ] 服务端无法处理

###### 401  Unauthorized

- [x] 请求的资源需要认证, 客户端没有提供认证信息或者认证信息不正确

###### 403  Forbidden

- [x] 服务器端接收到并理解客户端的请求, 但是客户端的权限不足

###### 404  Not Found

- [x] 客户端要访问的资源不存在, 链接失效或者客户端伪造 URL 的时候回遇到这个情况

###### 405 Method Not Allowed

- [x] 服务端接收到了请求, 而且要访问的资源也存在, 但是不支持对应的方法
- [ ] 服务端**必须**返回 `Allow` 头部, 告诉客户端哪些方法是允许的

###### 415  Unsupported Media Type

- [x] 服务端不支持客户端请求的资源格式
- [ ] 一般是因为客户端在 `Content-Type` 或者`Content-Encoding` 中申明了希望的返回格式, 但是服务端没有实现

###### 429  Too Many Requests

- [x] 客户端在规定的时间里发送了太多请求
- [ ] 在进行限流的时候会用到

###### 500  Internal Server Error

- [x] 服务器内部错误, 导致无法完成请求的内容

###### 503 Service Unavailable

- [x] 服务器因为负载过高或者维护, 暂时无法提供服务
- [ ]  服务器端应该返回 `Retry-After` 头部, 告诉客户端过一段时间再来重试

##### 验证与授权

- [x] 基本用户账户密码认证
- [x] Token
- [ ] Access_Token

##### 响应JSON数据格式

- [x] 采用JSON格式，并且根据需求定制统一规范的格式
- [ ] 可以根据需要添加status状态码

~~~json
{
    "code": 1,
    "msg": "success",
    "data": []
}
~~~

##### 条件过滤

~~~
/v1/products?page=1&pageSize=10 
~~~

~~~json
{
    "code": 1,
    "msg": "success",
    "data": {
		"total": 200,
        "page": 1,
        "pageSize": 10,
        "items": []
    }
}
~~~

##### 错误处理

- [x] 提供错误代码
- [x] 提供准确的错误信息

~~~json
{
	"code": 0,
	"msg": "Invalid API key",
    "data": null
}
~~~

##### 限流

##### 超媒体

##### API文档

- [x] 在线API文档、版本、地址
- [ ] 请求方法、参数、类型
- [ ] 响应字段、类型、中文描述