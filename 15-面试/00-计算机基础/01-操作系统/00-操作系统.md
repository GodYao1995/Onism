[TOC]

## 操作系统

### 什么是操作系统？

1.  操作系统是管理计算机硬件和软件的程序
2.  本质也是一种运行在硬件上的软件
3.  提供如下的功能
    *   进程管理
    *   **内存管理**
    *   文件管理
    *   设备管理

### 进程？

1.  操作系统分配资源的最小单位
2.  进程控制块 (Process Control Block, PCB) 描述进程的基本信息和运行状态
3.  线程是独立的调度执行的最小单位
4.  一个进程中可以有多个线程，共享进程资源
5.  创建进程的开销和调度进程的开销大于线程的创建和调度

#### 切换状态？

1.  创建
2.  就绪，处理处理器其他资源都获取到了
3.  运行，处理器执行
4.  阻塞，发生系统调用，等待IO
5.  结束

#### 调度算法？

1.  先到先服务
2.  短作业优先
3.  时间片轮转
4.  多级反馈队列【协调等待时间、短作业】

#### 进程同步？

控制多个进程按照顺序进行

1.  临界区，为了互斥访问临界资源，每个进程在进入临界区之前，需要先进行检查
2.  互斥量
3.  信号量，整形数字  down和up操作，如果是0 和 1 那就是互斥量
4.  事件，等待通知的模式

#### 进程通信？

进程间传输信息

1.  管道，匿名管道
    *   父子进程或兄弟进程使用
    *   半双工通信，单向交替传输
2.  有名管道，FIFO
    *   磁盘形式存在
    *   用于本机进程通信
3.  消息队列
    *   存放在内存中的消息链表，支持随机查询
    *   独立与读写进程存在
    *   FIFO的机制，不需要同步控制
4.  信号量，计数器用于多进程对共享资源的访问
5.  共享内存，一般需要同步机制来控制资源的访问
6.  套接字

### 死锁

#### 必要条件

1.  互斥，资源要么已经分配给了一个进程要么就是可用的
2.  占有和等待，已经得到某个资源的进程可以在请求新的资源
3.  不可抢占，已经分配的资源只能有拥有方主动释放不能被抢占
4.  环路等待

#### 处理死锁

1.  死锁检测，不试图阻止死锁，而是当检测到死锁发生时，采取措施进行恢复。
2.  死锁恢复，杀死进程恢复，回滚恢复等
3.  死锁预防，破坏死锁的必要条件
4.  死锁避免，利用好的算法避免死锁的发生

### 内存管理

1.  内存的分配与回收
2.  逻辑地址与物理地址的映射

#### 虚拟内存

1.  为了让物理内存扩充成更大的逻辑内存，从而让程序获得更多的可用内存
2.  虚拟内存为每个进程提供了一个一致的、私有的地址空间，它让每个进程产生了 一种自己在独享主存的错觉
3.  虚拟内存采用分页技术，将地址空间划分为页，然后与物理地址映射

#### 虚拟地址

1.  不能将物理地址暴露出来，多个程序运行会有问题
2.  CPU需要将翻译虚拟地址为物理地址
3.  不同的进程使用虚拟地址隔离

#### 管理机制

分为连续管理与非连续管理

1.  块式管理，将内存分为连续的块，以块为单位分配给进程，大小不好划分容易造成内存碎片
2.  页式管理，将内存分为页，页比较小可以合理分配，提高利用率减少内存碎片，通过页表管理逻辑物理地址
3.  段式管理，比页管理更为的精细，段中定义一组逻辑信息，通过段表管理逻辑与物理地址
4.  段页式管理，在页的基础上，将每个页分为若干段

#### 分页地址映射

1.  页表存储程序地址空间和物理地址空间的映射关系
2.  虚拟地址分为：页面号和存储偏移量

#### 页面置换算法

在程序运行过程中，如果要访问的页面不在内存中，就发生缺页中断从而将该页调入内存中。此时如果内存已无空闲空间，系统必须从内存中调出一个页面到磁盘对换区中来腾出空间

1.  最佳页面置换算法，淘汰以后永久不实用或者长时间不使用的
2.  先进先出置换算法，淘汰最先进入内存的页面
3.  LRU，淘汰最近最久未使用，维护一个页面链表，每次使用一个页面都会移动到表头
4.  LFU，淘汰最近最少使用

#### 分段地址映射

分段的做法是把每个页分成段，一个段构成一个独立的地址空间。每个段的长度可以不同，并且可以动态增长

#### 段页式

1.  程序的地址空间划分成多个拥有独立地址空间的段，每个段上的地址空间划分成大小相同的页。这样既拥有分段系统的共享和保护，又拥有分页系统的虚拟内存功能
2.  分页主要用于实现虚拟内存，从而获得更大的地址空间；分段主要是为了使程序和数据可以被划分为逻辑上独立的地址空间并且有助于共享和保护